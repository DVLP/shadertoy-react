"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"NearestFilter",{enumerable:!0,get:function(){return _Texture.NearestFilter}}),Object.defineProperty(exports,"LinearFilter",{enumerable:!0,get:function(){return _Texture.LinearFilter}}),Object.defineProperty(exports,"NearestMipMapNearestFilter",{enumerable:!0,get:function(){return _Texture.NearestMipMapNearestFilter}}),Object.defineProperty(exports,"LinearMipMapNearestFilter",{enumerable:!0,get:function(){return _Texture.LinearMipMapNearestFilter}}),Object.defineProperty(exports,"NearestMipMapLinearFilter",{enumerable:!0,get:function(){return _Texture.NearestMipMapLinearFilter}}),Object.defineProperty(exports,"LinearMipMapLinearFilter",{enumerable:!0,get:function(){return _Texture.LinearMipMapLinearFilter}}),Object.defineProperty(exports,"ClampToEdgeWrapping",{enumerable:!0,get:function(){return _Texture.ClampToEdgeWrapping}}),Object.defineProperty(exports,"MirroredRepeatWrapping",{enumerable:!0,get:function(){return _Texture.MirroredRepeatWrapping}}),Object.defineProperty(exports,"RepeatWrapping",{enumerable:!0,get:function(){return _Texture.RepeatWrapping}}),exports.default=void 0;var _react=_interopRequireWildcard(require("react")),_Texture=_interopRequireWildcard(require("./Texture"));function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};i.get||i.set?Object.defineProperty(r,t,i):r[t]=e[t]}return r.default=e,r}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},i=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.forEach(function(e){_defineProperty(r,e,t[e])})}return r}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}function _possibleConstructorReturn(e,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?_assertThisInitialized(e):r}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&_setPrototypeOf(e,r)}function _setPrototypeOf(e,r){return(_setPrototypeOf=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(e,r)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var FS_PRECISION_PREPROCESSOR="#ifdef GL_ES\n    precision highp float;\n#endif\n",FS_MAIN_SHADER="\nvoid main(void){\n    vec4 color = vec4(0.0,0.0,0.0,1.0);\n    mainImage( color, gl_FragCoord.xy );\n    gl_FragColor = color;\n}",BASIC_FS="void mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    vec2 uv = fragCoord/iResolution.xy;\n    vec3 col = 0.5 + 0.5*cos(iTime+uv.xyx+vec3(0,2,4));\n    fragColor = vec4(col,1.0);\n}",BASIC_VS="attribute vec3 aVertexPosition;\nvoid main(void) {\n    gl_Position = vec4(aVertexPosition, 1.0);\n}",UNIFORM_TIME="iTime",UNIFORM_TIMEDELTA="iTimeDelta",UNIFORM_DATE="iDate",UNIFORM_FRAME="iFrame",UNIFORM_MOUSE="iMouse",UNIFORM_RESOLUTION="iResolution",UNIFORM_CHANNEL="iChannel",UNIFORM_CHANNELRESOLUTION="iChannelResolution",lerpVal=function(e,r,t){return e*(1-t)+r*t},insertStringAtIndex=function(e,r,t){return 0<t?e.substring(0,t)+r+e.substring(t,e.length):r+e},ShadertoyReact=function(e){function t(e){var r,c;return _classCallCheck(this,t),c=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e)),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"componentDidMount",function(){c.initWebGL();var e=c.props,r=e.fs,t=e.vs,i=e.textures,n=e.onDoneLoadingTextures,a=_assertThisInitialized(_assertThisInitialized(c)).gl;if(a){if(a.clearColor(0,0,0,1),a.clearDepth(1),a.enable(a.DEPTH_TEST),a.depthFunc(a.LEQUAL),a.viewport(0,0,c.canvas.width,c.canvas.height),c.canvas.height=c.canvas.clientHeight,c.canvas.width=c.canvas.clientWidth,i&&0<i.length){c.uniforms["".concat(UNIFORM_CHANNELRESOLUTION)]={type:"vec3",isNeeded:!1,arraySize:"[".concat(i.length-1,"]"),value:[]};var o=i.map(function(e,r){return c.uniforms["".concat(UNIFORM_CHANNEL).concat(r)]={type:"sampler2D",isNeeded:!1},c.texturesArr[r]=new _Texture.default(a),c.texturesArr[r].load(e,r).then(function(e){return c.setupChannelRes(e,r)})});Promise.all(o).then(function(){n&&n()})}var s=c.preProcessShaders(r||BASIC_FS,t||BASIC_VS);c.initShaders(s),c.initBuffers(),c.drawScene(),c.addEventListeners(),c.onResize()}}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"shouldComponentUpdate",function(){return!1}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"setupChannelRes",function(e,r){var t=e.width,i=e.height;c.uniforms.iChannelResolution.value[3*r]=t,c.uniforms.iChannelResolution.value[3*r+1]=i,c.uniforms.iChannelResolution.value[3*r+2]=0}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"initWebGL",function(){var e=c.props.contextOptions;c.gl=c.canvas.getContext("webgl",e)||c.canvas.getContext("experimental-webgl",e),c.gl.getExtension("OES_standard_derivatives"),c.gl.getExtension("EXT_shader_texture_lod")}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"initBuffers",function(){var e=_assertThisInitialized(_assertThisInitialized(c)).gl;c.squareVerticesBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,c.squareVerticesBuffer);e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0]),e.STATIC_DRAW)}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"addEventListeners",function(){c.uniforms.iMouse.isNeeded&&(c.canvas.addEventListener("mousemove",c.mouseMove),c.canvas.addEventListener("mouseout",c.mouseUp),c.canvas.addEventListener("mouseup",c.mouseUp),c.canvas.addEventListener("mousedown",c.mouseDown),c.canvas.addEventListener("touchmove",c.mouseMove),c.canvas.addEventListener("touchend",c.mouseUp)),window.addEventListener("resize",c.onResize,{passive:!0})}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"removeEventListeners",function(){c.uniforms.iMouse.isNeeded&&(c.canvas.removeEventListener("mousemove",c.mouseMove),c.canvas.removeEventListener("mouseout",c.mouseUp),c.canvas.removeEventListener("mouseup",c.mouseUp),c.canvas.removeEventListener("mousedown",c.mouseDown),c.canvas.removeEventListener("touchmove",c.mouseMove),c.canvas.removeEventListener("touchend",c.mouseUp)),window.removeEventListener("resize",c.onResize,{passive:!0})}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"mouseDown",function(e){c.canvasPosition=c.canvas.getBoundingClientRect();var r=(e.clientX||e.touches[0].clientX)-c.canvasPosition.left,t=c.canvasPosition.height-(e.clientY||e.touches[0].clientY)-c.canvasPosition.top;c.mousedown=!0,c.uniforms.iMouse.value[2]=r,c.uniforms.iMouse.value[3]=t,c.lastMouseArr[0]=r,c.lastMouseArr[1]=t}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"mouseMove",function(e){var r=c.props.lerp,t=void 0===r?1:r;if(c.mousedown){var i=(e.clientX||e.touches[0].clientX)-c.canvasPosition.left,n=c.canvasPosition.height-(e.clientY||e.touches[0].clientY)-c.canvasPosition.top;1!==t?(c.lastMouseArr[0]=i,c.lastMouseArr[1]=n):(c.uniforms.iMouse.value[0]=i,c.uniforms.iMouse.value[1]=n)}}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"mouseUp",function(e){c.mousedown=!1,c.uniforms.iMouse.value[2]=0,c.uniforms.iMouse.value[3]=0}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"onResize",function(){var e=_assertThisInitialized(_assertThisInitialized(c)).gl,r=c.props.devicePixelRatio,t=void 0===r?1:r;c.canvasPosition=c.canvas.getBoundingClientRect();var i=t,n=Math.floor(c.canvasPosition.width*i),a=Math.floor(c.canvasPosition.height*i);if(e.canvas.width=n,e.canvas.height=a,c.uniforms.iResolution.isNeeded){var o=e.getUniformLocation(c.shaderProgram,UNIFORM_RESOLUTION);e.uniform2fv(o,[e.canvas.width,e.canvas.height])}}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"drawScene",function(e){var r=_assertThisInitialized(_assertThisInitialized(c)).gl,t=c.props.lerp,i=void 0===t?1:t;r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.bindBuffer(r.ARRAY_BUFFER,c.squareVerticesBuffer),r.vertexAttribPointer(c.vertexPositionAttribute,3,r.FLOAT,!1,0,0),c.setUniforms(e),r.drawArrays(r.TRIANGLE_STRIP,0,4),c.uniforms.iMouse.isNeeded&&1!==i&&(c.uniforms.iMouse.value[0]=lerpVal(c.uniforms.iMouse.value[0],c.lastMouseArr[0],i),c.uniforms.iMouse.value[1]=lerpVal(c.uniforms.iMouse.value[1],c.lastMouseArr[1],i)),c.animFrameId=requestAnimationFrame(c.drawScene)}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"createShader",function(e,r){var t=_assertThisInitialized(_assertThisInitialized(c)).gl,i=t.createShader(e);if(t.shaderSource(i,r),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){console.warn("Error compiling the shader:",r);var n=t.getShaderInfoLog(i);t.deleteShader(i),console.error("Shader compiler log: ".concat(n))}return i}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"initShaders",function(e){var r=e.fs,t=e.vs,i=_assertThisInitialized(_assertThisInitialized(c)).gl,n=c.createShader(i.FRAGMENT_SHADER,r),a=c.createShader(i.VERTEX_SHADER,t);c.shaderProgram=i.createProgram(),i.attachShader(c.shaderProgram,a),i.attachShader(c.shaderProgram,n),i.linkProgram(c.shaderProgram),i.getProgramParameter(c.shaderProgram,i.LINK_STATUS)?(i.useProgram(c.shaderProgram),c.vertexPositionAttribute=i.getAttribLocation(c.shaderProgram,"aVertexPosition"),i.enableVertexAttribArray(c.vertexPositionAttribute)):console.error("Unable to initialize the shader program: ".concat(i.getProgramInfoLog(c.shaderProgram)))}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"preProcessShaders",function(r,e){var t=FS_PRECISION_PREPROCESSOR.concat(r).replace(/texture\(/g,"texture2D("),i=t.lastIndexOf("#endif");return Object.keys(c.uniforms).forEach(function(e){r.includes(e)&&(t=insertStringAtIndex(t,"uniform ".concat(c.uniforms[e].type," ").concat(e).concat(c.uniforms[e].arraySize||"","; \n"),i+"#endif".length+1),c.uniforms[e].isNeeded=!0)}),{fs:t=t.concat(FS_MAIN_SHADER),vs:e}}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"setUniforms",function(e){var s=_assertThisInitialized(_assertThisInitialized(c)).gl,r=c.lastTime?(e-c.lastTime)/1e3:0;if(c.lastTime=e,c.uniforms.iMouse.isNeeded){var t=s.getUniformLocation(c.shaderProgram,UNIFORM_MOUSE);s.uniform4fv(t,[c.uniforms.iMouse.value[0],c.uniforms.iMouse.value[1],c.uniforms.iMouse.value[2],c.uniforms.iMouse.value[3]])}if(c.uniforms.iChannelResolution&&c.uniforms.iChannelResolution.isNeeded){var i=s.getUniformLocation(c.shaderProgram,UNIFORM_CHANNELRESOLUTION);s.uniform3fv(i,c.uniforms.iChannelResolution.value)}if(c.uniforms.iTime.isNeeded){var n=s.getUniformLocation(c.shaderProgram,UNIFORM_TIME);s.uniform1f(n,c.timer+=r)}if(c.uniforms.iTimeDelta.isNeeded){s.getUniformLocation(c.shaderProgram,UNIFORM_TIMEDELTA);s.uniform1f(timeUniform,r)}if(c.uniforms.iDate.isNeeded){var a=new Date,o=a.getMonth()+1,l=a.getDate(),u=a.getFullYear(),d=60*a.getHours()*60+60*a.getMinutes()+a.getSeconds(),p=s.getUniformLocation(c.shaderProgram,UNIFORM_DATE);s.uniform4fv(p,[u,o,l,d])}if(c.uniforms.iFrame.isNeeded){s.getUniformLocation(c.shaderProgram,UNIFORM_FRAME);s.uniform1f(timeUniform,c.uniforms.iFrame.value++)}0<c.texturesArr.length&&c.texturesArr.forEach(function(e,r){var t=e.isVideo,i=e._webglTexture,n=e.source,a=e.flipY;if(e.isLoaded&&c.uniforms["iChannel".concat(r)].isNeeded){var o=s.getUniformLocation(c.shaderProgram,"iChannel".concat(r));s.activeTexture(s["TEXTURE".concat(r)]),s.bindTexture(s.TEXTURE_2D,i),s.uniform1i(o,r),t&&e.updateTexture(i,n,a)}})}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"registerCanvas",function(e){c.canvas=e}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"gl",void 0),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"squareVerticesBuffer",void 0),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"shaderProgram",void 0),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"vertexPositionAttribute",void 0),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"animFrameId",void 0),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"timeoutId",void 0),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"canvas",void 0),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"mousedown",!1),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"canvasPosition",void 0),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"timer",0),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"lastMouseArr",[0,0]),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"texturesArr",[]),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"lastTime",0),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"render",function(){var e={glCanvas:_objectSpread({position:"absolute",height:"100%",width:"100%"},c.props.style)};return _react.default.createElement("canvas",{style:e.glCanvas,ref:c.registerCanvas})}),c.uniforms=(_defineProperty(r={},UNIFORM_TIME,{type:"float",isNeeded:!1,value:0}),_defineProperty(r,UNIFORM_TIMEDELTA,{type:"float",isNeeded:!1,value:0}),_defineProperty(r,UNIFORM_DATE,{type:"vec4",isNeeded:!1,value:[0,0,0,0]}),_defineProperty(r,UNIFORM_MOUSE,{type:"vec4",isNeeded:!1,value:[0,0,0,0]}),_defineProperty(r,UNIFORM_RESOLUTION,{type:"vec2",isNeeded:!1,value:[0,0]}),_defineProperty(r,UNIFORM_FRAME,{type:"int",isNeeded:!1,value:0}),r),c}return _inherits(t,_react.Component),_createClass(t,[{key:"componentWillUnmount",value:function(){var r=this.gl;r&&(r.getExtension("WEBGL_lose_context").loseContext(),r.useProgram(null),r.deleteProgram(this.shaderProgram),0<this.texturesArr.length&&this.texturesArr.forEach(function(e){r.deleteTexture(e.webglTexture)}),this.shaderProgram=null),this.removeEventListeners(),cancelAnimationFrame(this.animFrameId)}}]),t}();function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}exports.default=ShadertoyReact,_defineProperty(ShadertoyReact,"defaultProps",{textures:[],contextOptions:{premultipliedAlpha:!1,alpha:!0},devicePixelRatio:1,vs:BASIC_VS}),Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.RepeatWrapping=exports.MirroredRepeatWrapping=exports.ClampToEdgeWrapping=exports.LinearMipMapLinearFilter=exports.NearestMipMapLinearFilter=exports.LinearMipMapNearestFilter=exports.NearestMipMapNearestFilter=exports.LinearFilter=exports.NearestFilter=void 0;var NearestFilter=9728;exports.NearestFilter=NearestFilter;var LinearFilter=9729;exports.LinearFilter=LinearFilter;var NearestMipMapNearestFilter=9984;exports.NearestMipMapNearestFilter=NearestMipMapNearestFilter;var LinearMipMapNearestFilter=9985;exports.LinearMipMapNearestFilter=LinearMipMapNearestFilter;var NearestMipMapLinearFilter=9986;exports.NearestMipMapLinearFilter=NearestMipMapLinearFilter;var LinearMipMapLinearFilter=9987;exports.LinearMipMapLinearFilter=LinearMipMapLinearFilter;var ClampToEdgeWrapping=33071;exports.ClampToEdgeWrapping=ClampToEdgeWrapping;var MirroredRepeatWrapping=33648;exports.MirroredRepeatWrapping=MirroredRepeatWrapping;var RepeatWrapping=10497;exports.RepeatWrapping=RepeatWrapping;var isPowerOf2=function(e){return 0==(e&e-1)},floorPowerOfTwo=function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},textureNeedsGenerateMipmaps=function(e,r){return r&&e.minFilter!==NearestFilter&&e.minFilter!==LinearFilter},textureNeedsPowerOfTwo=function(e){return e.wrapS!==ClampToEdgeWrapping||e.wrapT!==ClampToEdgeWrapping||e.minFilter!==NearestFilter&&e.minFilter!==LinearFilter},Texture=function e(r){var g=this;_classCallCheck(this,e),_defineProperty(this,"isLoaded",!1),_defineProperty(this,"url",void 0),_defineProperty(this,"wrapS",void 0),_defineProperty(this,"wrapT",void 0),_defineProperty(this,"minFilter",void 0),_defineProperty(this,"magFilter",void 0),_defineProperty(this,"source",void 0),_defineProperty(this,"flipY",-1),_defineProperty(this,"width",0),_defineProperty(this,"height",0),_defineProperty(this,"_webglTexture",null),_defineProperty(this,"updateTexture",function(e,r,t){var i=g.gl,n=i.RGBA,a=i.RGBA,o=i.UNSIGNED_BYTE;i.bindTexture(i.TEXTURE_2D,e),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,t),i.texImage2D(i.TEXTURE_2D,0,n,a,o,r)}),_defineProperty(this,"setupVideo",function(e){var r=document.createElement("video"),t=!1,i=!1;r.autoplay=!0,r.muted=!0,r.loop=!0,r.crossOrigin="anonymous";var n=function(){t&&i&&(g.isLoaded=!0)};return r.addEventListener("playing",function(){t=!0,g.width=r.videoWidth||0,g.height=r.videoHeight||0,n()},!0),r.addEventListener("timeupdate",function(){i=!0,n()},!0),r.src=e,r}),_defineProperty(this,"makePowerOfTwo",function(e){return e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageBitmap?(void 0===g.pow2canvas&&(g.pow2canvas=document.createElement("canvas")),g.pow2canvas.width=floorPowerOfTwo(e.width),g.pow2canvas.height=floorPowerOfTwo(e.height),g.pow2canvas.getContext("2d").drawImage(e,0,0,g.pow2canvas.width,g.pow2canvas.height),console.warn("ShadertoyReact: Image is not power of two ".concat(e.width," x ").concat(e.height,". Resized to ").concat(g.pow2canvas.width," x ").concat(g.pow2canvas.height)),g.pow2canvas):e}),_defineProperty(this,"load",function(t,e){var i=g.gl,n=t.url,r=t.wrapS,a=t.wrapT,o=t.minFilter,s=t.magFilter,l=t.flipY,u=void 0===l?-1:l;if(g.url=n,g.wrapS=r,g.wrapT=a,g.minFilter=o,g.magFilter=s,g.flipY=u,null!==d||null!==p){var d=/(\.jpg|\.jpeg|\.png|\.gif|\.bmp)$/i.exec(n),p=/(\.mp4|\.3gp|\.webm|\.ogv)$/i.exec(n);if(null!==d||null!==p){var c=i.createTexture();i.bindTexture(i.TEXTURE_2D,c);var f=i.RGBA,_=i.RGBA,h=i.UNSIGNED_BYTE,v=new Uint8Array([255,255,255,0]);if(i.texImage2D(i.TEXTURE_2D,0,f,1,1,0,_,h,v),p){var m=g.setupVideo(n);return i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),g._webglTexture=c,g.source=m,g.isVideo=!0,m.play().then(function(){return g})}return new Promise(function(e,r){var t=new Image;t.crossOrigin="anonymous",t.onload=function(){return e(t)},t.onerror=function(){return r(new Error("failed loading url: ".concat(n)))},t.src=n}).then(function(e){var r=isPowerOf2(e.width)&&isPowerOf2(e.height);return textureNeedsPowerOfTwo(t)&&!1===r&&(e=g.makePowerOfTwo(e),r=!0),i.bindTexture(i.TEXTURE_2D,c),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,u),i.texImage2D(i.TEXTURE_2D,0,f,_,h,e),textureNeedsGenerateMipmaps(t,r)&&i.generateMipmap(i.TEXTURE_2D),g._webglTexture=c,g.source=e,g.isVideo=!1,g.isLoaded=!0,g.width=e.width||0,g.height=e.height||0,g})}console.error("ShadertoyReact: please upload a video or an image with a valid format",n)}else console.error("ShadertoyReact: Missing url, please make sure to pass the url of your texture { url: ... }")}),this.gl=r};exports.default=Texture;