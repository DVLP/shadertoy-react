define(["exports"],function(e){"use strict";function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.RepeatWrapping=e.MirroredRepeatWrapping=e.ClampToEdgeWrapping=e.LinearMipMapLinearFilter=e.NearestMipMapLinearFilter=e.LinearMipMapNearestFilter=e.NearestMipMapNearestFilter=e.LinearFilter=e.NearestFilter=void 0;var w=9728;e.NearestFilter=w;var b=9729;e.LinearFilter=b;e.NearestMipMapNearestFilter=9984;e.LinearMipMapNearestFilter=9985;e.NearestMipMapLinearFilter=9986;e.LinearMipMapLinearFilter=9987;var P=33071;e.ClampToEdgeWrapping=P;e.MirroredRepeatWrapping=33648;e.RepeatWrapping=10497;var T=function(e){return 0==(e&e-1)},n=function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))};e.default=function e(t){var E=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,"isLoaded",!1),r(this,"url",void 0),r(this,"wrapS",void 0),r(this,"wrapT",void 0),r(this,"minFilter",void 0),r(this,"magFilter",void 0),r(this,"source",void 0),r(this,"flipY",-1),r(this,"width",0),r(this,"height",0),r(this,"_webglTexture",null),r(this,"updateTexture",function(e,t,r){var n=E.gl,i=n.RGBA,o=n.RGBA,a=n.UNSIGNED_BYTE;n.bindTexture(n.TEXTURE_2D,e),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,r),n.texImage2D(n.TEXTURE_2D,0,i,o,a,t)}),r(this,"setupVideo",function(e){var t=document.createElement("video"),r=!1,n=!1;t.autoplay=!0,t.muted=!0,t.loop=!0,t.crossOrigin="anonymous";var i=function(){r&&n&&(E.isLoaded=!0)};return t.addEventListener("playing",function(){r=!0,E.width=t.videoWidth||0,E.height=t.videoHeight||0,i()},!0),t.addEventListener("timeupdate",function(){n=!0,i()},!0),t.src=e,t}),r(this,"makePowerOfTwo",function(e){return e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageBitmap?(void 0===E.pow2canvas&&(E.pow2canvas=document.createElement("canvas")),E.pow2canvas.width=n(e.width),E.pow2canvas.height=n(e.height),E.pow2canvas.getContext("2d").drawImage(e,0,0,E.pow2canvas.width,E.pow2canvas.height),console.warn("ShadertoyReact: Image is not power of two ".concat(e.width," x ").concat(e.height,". Resized to ").concat(E.pow2canvas.width," x ").concat(E.pow2canvas.height)),E.pow2canvas):e}),r(this,"load",function(i,e){var o=E.gl,n=i.url,t=i.wrapS,r=i.wrapT,a=i.minFilter,s=i.magFilter,u=i.flipY,c=void 0===u?-1:u;if(E.url=n,E.wrapS=t,E.wrapT=r,E.minFilter=a,E.magFilter=s,E.flipY=c,null!==l||null!==f){var l=/(\.jpg|\.jpeg|\.png|\.gif|\.bmp)$/i.exec(n),f=/(\.mp4|\.3gp|\.webm|\.ogv)$/i.exec(n);if(null!==l||null!==f){var d=o.createTexture();o.bindTexture(o.TEXTURE_2D,d);var v=o.RGBA,m=o.RGBA,p=o.UNSIGNED_BYTE,g=new Uint8Array([255,255,255,0]);if(o.texImage2D(o.TEXTURE_2D,0,v,1,1,0,m,p,g),f){var h=E.setupVideo(n);return o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),E._webglTexture=d,E.source=h,E.isVideo=!0,h.play().then(function(){return E})}return new Promise(function(e,t){var r=new Image;r.crossOrigin="anonymous",r.onload=function(){return e(r)},r.onerror=function(){return t(new Error("failed loading url: ".concat(n)))},r.src=n}).then(function(e){var t,r,n=T(e.width)&&T(e.height);return((t=i).wrapS!==P||t.wrapT!==P||t.minFilter!==w&&t.minFilter!==b)&&!1===n&&(e=E.makePowerOfTwo(e),n=!0),o.bindTexture(o.TEXTURE_2D,d),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,c),o.texImage2D(o.TEXTURE_2D,0,v,m,p,e),r=i,n&&r.minFilter!==w&&r.minFilter!==b&&o.generateMipmap(o.TEXTURE_2D),E._webglTexture=d,E.source=e,E.isVideo=!1,E.isLoaded=!0,E.width=e.width||0,E.height=e.height||0,E})}console.error("ShadertoyReact: please upload a video or an image with a valid format",n)}else console.error("ShadertoyReact: Missing url, please make sure to pass the url of your texture { url: ... }")}),this.gl=t}}),define(["exports","react","./Texture"],function(e,o,u){"use strict";function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"NearestFilter",{enumerable:!0,get:function(){return u.NearestFilter}}),Object.defineProperty(e,"LinearFilter",{enumerable:!0,get:function(){return u.LinearFilter}}),Object.defineProperty(e,"NearestMipMapNearestFilter",{enumerable:!0,get:function(){return u.NearestMipMapNearestFilter}}),Object.defineProperty(e,"LinearMipMapNearestFilter",{enumerable:!0,get:function(){return u.LinearMipMapNearestFilter}}),Object.defineProperty(e,"NearestMipMapLinearFilter",{enumerable:!0,get:function(){return u.NearestMipMapLinearFilter}}),Object.defineProperty(e,"LinearMipMapLinearFilter",{enumerable:!0,get:function(){return u.LinearMipMapLinearFilter}}),Object.defineProperty(e,"ClampToEdgeWrapping",{enumerable:!0,get:function(){return u.ClampToEdgeWrapping}}),Object.defineProperty(e,"MirroredRepeatWrapping",{enumerable:!0,get:function(){return u.MirroredRepeatWrapping}}),Object.defineProperty(e,"RepeatWrapping",{enumerable:!0,get:function(){return u.RepeatWrapping}}),e.default=void 0,o=t(o),u=t(u);var m="attribute vec3 aVertexPosition;\nvoid main(void) {\n    gl_Position = vec4(aVertexPosition, 1.0);\n}",p="iTimeDelta",g="iResolution",h="iChannelResolution",E=function(e,t,r){return e*(1-r)+t*r},r=function(e){function i(e){var t,d,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r=this,n=c(i).call(this,e),f(v(v(d=!n||"object"!==a(n)&&"function"!=typeof n?v(r):n)),"componentDidMount",function(){d.initWebGL();var e=d.props,t=e.fs,r=e.vs,n=e.textures,i=e.onDoneLoadingTextures,o=v(v(d)).gl;if(o){if(o.clearColor(0,0,0,1),o.clearDepth(1),o.enable(o.DEPTH_TEST),o.depthFunc(o.LEQUAL),o.viewport(0,0,d.canvas.width,d.canvas.height),d.canvas.height=d.canvas.clientHeight,d.canvas.width=d.canvas.clientWidth,n&&0<n.length){d.uniforms["".concat(h)]={type:"vec3",isNeeded:!1,arraySize:"[".concat(n.length-1,"]"),value:[]};var a=n.map(function(e,t){return d.uniforms["".concat("iChannel").concat(t)]={type:"sampler2D",isNeeded:!1},d.texturesArr[t]=new u.default(o),d.texturesArr[t].load(e,t).then(function(e){return d.setupChannelRes(e,t)})});Promise.all(a).then(function(){i&&i()})}var s=d.preProcessShaders(t||"void mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    vec2 uv = fragCoord/iResolution.xy;\n    vec3 col = 0.5 + 0.5*cos(iTime+uv.xyx+vec3(0,2,4));\n    fragColor = vec4(col,1.0);\n}",r||m);d.initShaders(s),d.initBuffers(),d.drawScene(),d.addEventListeners(),d.onResize()}}),f(v(v(d)),"shouldComponentUpdate",function(){return!1}),f(v(v(d)),"setupChannelRes",function(e,t){var r=e.width,n=e.height;d.uniforms.iChannelResolution.value[3*t]=r,d.uniforms.iChannelResolution.value[3*t+1]=n,d.uniforms.iChannelResolution.value[3*t+2]=0}),f(v(v(d)),"initWebGL",function(){var e=d.props.contextAttributes;d.gl=d.canvas.getContext("webgl",e)||d.canvas.getContext("experimental-webgl",e),d.gl.getExtension("OES_standard_derivatives"),d.gl.getExtension("EXT_shader_texture_lod")}),f(v(v(d)),"initBuffers",function(){var e=v(v(d)).gl;d.squareVerticesBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,d.squareVerticesBuffer);e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0]),e.STATIC_DRAW)}),f(v(v(d)),"addEventListeners",function(){d.uniforms.iMouse.isNeeded&&(d.canvas.addEventListener("mousemove",d.mouseMove),d.canvas.addEventListener("mouseout",d.mouseUp),d.canvas.addEventListener("mouseup",d.mouseUp),d.canvas.addEventListener("mousedown",d.mouseDown),d.canvas.addEventListener("touchmove",d.mouseMove),d.canvas.addEventListener("touchend",d.mouseUp)),window.addEventListener("resize",d.onResize,{passive:!0})}),f(v(v(d)),"removeEventListeners",function(){d.uniforms.iMouse.isNeeded&&(d.canvas.removeEventListener("mousemove",d.mouseMove),d.canvas.removeEventListener("mouseout",d.mouseUp),d.canvas.removeEventListener("mouseup",d.mouseUp),d.canvas.removeEventListener("mousedown",d.mouseDown),d.canvas.removeEventListener("touchmove",d.mouseMove),d.canvas.removeEventListener("touchend",d.mouseUp)),window.removeEventListener("resize",d.onResize,{passive:!0})}),f(v(v(d)),"mouseDown",function(e){d.canvasPosition=d.canvas.getBoundingClientRect();var t=(e.clientX||e.touches[0].clientX)-d.canvasPosition.left,r=d.canvasPosition.height-(e.clientY||e.touches[0].clientY)-d.canvasPosition.top;d.mousedown=!0,d.uniforms.iMouse.value[2]=t,d.uniforms.iMouse.value[3]=r,d.lastMouseArr[0]=t,d.lastMouseArr[1]=r}),f(v(v(d)),"mouseMove",function(e){var t=d.props.lerp,r=void 0===t?1:t;if(d.mousedown){var n=(e.clientX||e.touches[0].clientX)-d.canvasPosition.left,i=d.canvasPosition.height-(e.clientY||e.touches[0].clientY)-d.canvasPosition.top;1!==r?(d.lastMouseArr[0]=n,d.lastMouseArr[1]=i):(d.uniforms.iMouse.value[0]=n,d.uniforms.iMouse.value[1]=i)}}),f(v(v(d)),"mouseUp",function(e){d.mousedown=!1,d.uniforms.iMouse.value[2]=0,d.uniforms.iMouse.value[3]=0}),f(v(v(d)),"onResize",function(){var e=v(v(d)).gl,t=d.props.devicePixelRatio,r=void 0===t?1:t;d.canvasPosition=d.canvas.getBoundingClientRect();var n=r,i=Math.floor(d.canvasPosition.width*n),o=Math.floor(d.canvasPosition.height*n);if(e.canvas.width=i,e.canvas.height=o,d.uniforms.iResolution.isNeeded){var a=e.getUniformLocation(d.shaderProgram,g);e.uniform2fv(a,[e.canvas.width,e.canvas.height])}}),f(v(v(d)),"drawScene",function(e){var t=v(v(d)).gl,r=d.props.lerp,n=void 0===r?1:r;t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.bindBuffer(t.ARRAY_BUFFER,d.squareVerticesBuffer),t.vertexAttribPointer(d.vertexPositionAttribute,3,t.FLOAT,!1,0,0),d.setUniforms(e),t.drawArrays(t.TRIANGLE_STRIP,0,4),d.uniforms.iMouse.isNeeded&&1!==n&&(d.uniforms.iMouse.value[0]=E(d.uniforms.iMouse.value[0],d.lastMouseArr[0],n),d.uniforms.iMouse.value[1]=E(d.uniforms.iMouse.value[1],d.lastMouseArr[1],n)),d.animFrameId=requestAnimationFrame(d.drawScene)}),f(v(v(d)),"createShader",function(e,t){var r=v(v(d)).gl,n=r.createShader(e);if(r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS)){console.warn("Error compiling the shader:",t);var i=r.getShaderInfoLog(n);r.deleteShader(n),console.error("Shader compiler log: ".concat(i))}return n}),f(v(v(d)),"initShaders",function(e){var t=e.fs,r=e.vs,n=v(v(d)).gl,i=d.createShader(n.FRAGMENT_SHADER,t),o=d.createShader(n.VERTEX_SHADER,r);d.shaderProgram=n.createProgram(),n.attachShader(d.shaderProgram,o),n.attachShader(d.shaderProgram,i),n.linkProgram(d.shaderProgram),n.getProgramParameter(d.shaderProgram,n.LINK_STATUS)?(n.useProgram(d.shaderProgram),d.vertexPositionAttribute=n.getAttribLocation(d.shaderProgram,"aVertexPosition"),n.enableVertexAttribArray(d.vertexPositionAttribute)):console.error("Unable to initialize the shader program: ".concat(n.getProgramInfoLog(d.shaderProgram)))}),f(v(v(d)),"preProcessShaders",function(i,e){var o="#ifdef GL_ES\n    precision highp float;\n#endif\n".concat(i).replace(/texture\(/g,"texture2D("),a=o.lastIndexOf("#endif");return Object.keys(d.uniforms).forEach(function(e){var t,r,n;i.includes(e)&&(t=o,r="uniform ".concat(d.uniforms[e].type," ").concat(e).concat(d.uniforms[e].arraySize||"","; \n"),o=0<(n=a+"#endif".length+1)?t.substring(0,n)+r+t.substring(n,t.length):r+t,d.uniforms[e].isNeeded=!0)}),{fs:o=o.concat("\nvoid main(void){\n    vec4 color = vec4(0.0,0.0,0.0,1.0);\n    mainImage( color, gl_FragCoord.xy );\n    gl_FragColor = color;\n}"),vs:e}}),f(v(v(d)),"setUniforms",function(e){var s=v(v(d)).gl,t=d.lastTime?(e-d.lastTime)/1e3:0;if(d.lastTime=e,d.uniforms.iMouse.isNeeded){var r=s.getUniformLocation(d.shaderProgram,"iMouse");s.uniform4fv(r,[d.uniforms.iMouse.value[0],d.uniforms.iMouse.value[1],d.uniforms.iMouse.value[2],d.uniforms.iMouse.value[3]])}if(d.uniforms.iChannelResolution&&d.uniforms.iChannelResolution.isNeeded){var n=s.getUniformLocation(d.shaderProgram,h);s.uniform3fv(n,d.uniforms.iChannelResolution.value)}if(d.uniforms.iTime.isNeeded){var i=s.getUniformLocation(d.shaderProgram,"iTime");s.uniform1f(i,d.timer+=t)}if(d.uniforms.iTimeDelta.isNeeded){s.getUniformLocation(d.shaderProgram,p);s.uniform1f(timeUniform,t)}if(d.uniforms.iDate.isNeeded){var o=new Date,a=o.getMonth()+1,u=o.getDate(),c=o.getFullYear(),l=60*o.getHours()*60+60*o.getMinutes()+o.getSeconds(),f=s.getUniformLocation(d.shaderProgram,"iDate");s.uniform4fv(f,[c,a,u,l])}if(d.uniforms.iFrame.isNeeded){s.getUniformLocation(d.shaderProgram,"iFrame");s.uniform1f(timeUniform,d.uniforms.iFrame.value++)}0<d.texturesArr.length&&d.texturesArr.forEach(function(e,t){var r=e.isVideo,n=e._webglTexture,i=e.source,o=e.flipY;if(e.isLoaded&&d.uniforms["iChannel".concat(t)].isNeeded){var a=s.getUniformLocation(d.shaderProgram,"iChannel".concat(t));s.activeTexture(s["TEXTURE".concat(t)]),s.bindTexture(s.TEXTURE_2D,n),s.uniform1i(a,t),r&&e.updateTexture(n,i,o)}})}),f(v(v(d)),"registerCanvas",function(e){d.canvas=e}),f(v(v(d)),"gl",void 0),f(v(v(d)),"squareVerticesBuffer",void 0),f(v(v(d)),"shaderProgram",void 0),f(v(v(d)),"vertexPositionAttribute",void 0),f(v(v(d)),"animFrameId",void 0),f(v(v(d)),"timeoutId",void 0),f(v(v(d)),"canvas",void 0),f(v(v(d)),"mousedown",!1),f(v(v(d)),"canvasPosition",void 0),f(v(v(d)),"timer",0),f(v(v(d)),"lastMouseArr",[0,0]),f(v(v(d)),"texturesArr",[]),f(v(v(d)),"lastTime",0),f(v(v(d)),"render",function(){var e={glCanvas:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(e){f(t,e,r[e])})}return t}({position:"absolute",height:"100%",width:"100%"},d.props.style)};return o.default.createElement("canvas",{style:e.glCanvas,ref:d.registerCanvas})}),d.uniforms=(f(t={},"iTime",{type:"float",isNeeded:!1,value:0}),f(t,p,{type:"float",isNeeded:!1,value:0}),f(t,"iDate",{type:"vec4",isNeeded:!1,value:[0,0,0,0]}),f(t,"iMouse",{type:"vec4",isNeeded:!1,value:[0,0,0,0]}),f(t,g,{type:"vec2",isNeeded:!1,value:[0,0]}),f(t,"iFrame",{type:"int",isNeeded:!1,value:0}),t),d}var t,r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(i,o.Component),t=i,(r=[{key:"componentWillUnmount",value:function(){var t=this.gl;t&&(t.getExtension("WEBGL_lose_context").loseContext(),t.useProgram(null),t.deleteProgram(this.shaderProgram),0<this.texturesArr.length&&this.texturesArr.forEach(function(e){t.deleteTexture(e.webglTexture)}),this.shaderProgram=null),this.removeEventListeners(),cancelAnimationFrame(this.animFrameId)}}])&&s(t.prototype,r),n&&s(t,n),i}();f(e.default=r,"defaultProps",{textures:[],contextAttributes:{premultipliedAlpha:!1,alpha:!0},devicePixelRatio:1,vs:m})});